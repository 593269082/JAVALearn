# JAVALearn
 JAVA面试相关各种知识
1.死锁问题是什么，现象
![image](80684d2487ca33b0a971c57c/c4074813bd29549515281daa.png)
进程的并发执行导致死锁；
A占有a，需要b才能释放a
B占有b，需要a才能释放b
![image](08c2439fb9cd5f64ff8d8ead/03f0403e8ab2b57d65b945c0.png)
2.死锁模型
![image](1fc3401e879f6cce92f80c54/c94b4a1394807d52ebee9ba9.png)
资源具有互斥性
有限时间
![image](8dbb4a70aba09e6aec3c6efe/1f1447ba951d7e71ae13a9ef.png)
![image](36624cf9820858bec47fe9c4/e3574837b925914c85b9fa29.png)
![image](828f466592372594306a2289/89534c8bab46ae8cc2040279.png)
![image](215d4a4e81bc9769c8bd5625/551e4a4fbf3de2d600d3d36d.png)
一旦出现死锁，资源分配图形成了一个环
死锁产生后一个很典型的特征
![image](a33d4a8ea21e62f54fe97cc3/c04a428e8f9fe6514ea58e38.png)
3.死锁的特征
**互斥**
    一个时间内，只能有一个进程使用资源
**持有并等待**
    进程保持至少一个资源正在等待其他进程持有的额外资源
**无抢占**
    不能强行拿走资源
**循环等待**
    形成一个环
死锁的四个必要条件，有了死锁会有四个条件出现
有四个条件不等于死锁，死锁是因，条件是果
4.如何有效解决死锁问题
·死锁预防，死锁避免，死锁检测，死锁恢复
三种：
确保系统永远不会进入死锁状态，没病
运行系统进入死锁状态，然后恢复，有病治病
忽略这个问题，假装系统没有死锁，假装没病 Unix

**死锁预防**
限制申请方式
互斥，共享资源不是必须的，必须占用非共享资源，不太好
占用并等待，必须保证当一个进程请求的资源，不持有任何其他资源
必须拿到全部资源，资源利用率低，不太可行
无抢占 抢占其他的，打破进程，无法正常工作
**循环等待**，是好办法！
打破环，对资源类型进行排序，要求每个进程按照资源的顺序进行申请。
![image](7c53457dbeab449c7e52108e/9cdb4f2b86ce763a13365ebd.png)
**死锁避免**
![image](2a6c4b10951cfb89b097520f/36694954bf314f4fa88760a6.png)
![image](0457408c83ceee4448a32a02/b43a4a869332959738f6158a.png)
**安全状态**，存在所有进程，存在安全序列
![image](ebd742ff837de6ed71aa530e/df5b470eadc8e89557460a49.png)
**不安全状态**是更大的集合，包含了死锁状态
![image](861e423a81f36759c7b42ce8/5762404abb0fa225b294ec1d.png)

**银行家算法**
避免死锁产生的算法
**数据结构**
![image](e8b24e1f8470ed2782de5ae7/c7b14ea39b40a27cfea2370a.png)
**安全状态检测算法**
![image](7ed14b029b70ccf53b9c9166/a3504b09931331c027f16912.png)
对每个进程，模拟分配资源，然后判断是否出于安全状态
**银行家算法介绍**
![image](b83c413a8def039aab84398b/01754789a92efe1e74584177.png)
当一个进程申请使用资源的时候，银行家算法通过先试探分配给该进程资源，然后通过安全性算法判断分配后的系统是否出于安全状态，若不安全则试探分配作废，让该进程继续等待。
![image](457641e7bee4ed78a6f80f23/ad7a40c6ab74bb97813f391f.png)
![image](ae69487f9c8d8e3dbcf4c417/2a4249ef8547f83a09062e4d.png)
所谓安全性检查，其实就是将剩余的资源，首先分配给比这些资源少的进程，然后得到已分配资源，然后继续分配。
所谓的银行家算法，其实就是轮流查看分配给每个进程是否能得到安全状态。
如果能得到安全状态，就分配。
例子：
![image](b0cd47a984d5a6939ca85ee2/a5d441ea9b8e4e1e48d1c0ff.png)
**银行机算法能够改善资源使用率低的问题，但是要不断检测以及安全性检查，需要花费较多时间。**


